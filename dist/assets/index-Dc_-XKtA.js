import{r as h,j as t}from"./index-7FYdZ7LW.js";import{a as d,S as p}from"./index-UIRDH5-G.js";import{c as x}from"./react--KxBXeKu.js";import{u as j}from"./useTitle-I86CEnKF.js";import"./ArrowLeft-DLpVywrw.js";const L="_container_1ylrc_1",H="_wrapper_1ylrc_27",N="_suggestWrapper_1ylrc_65",S="_title_1ylrc_83",f="_hot_1ylrc_105",v="_historyList_1ylrc_105",w="_suggestContainer_1ylrc_127",I="_list_1ylrc_141",B="_item_1ylrc_159",C="_history_1ylrc_105",W="_historyItem_1ylrc_239",E="_clearBtn_1ylrc_279",b="_empty_1ylrc_327",s={container:L,wrapper:H,suggestWrapper:N,title:S,hot:f,historyList:v,suggestContainer:w,list:I,item:B,history:C,historyItem:W,clearBtn:E,empty:b},J=async()=>{try{const a=(await d.get("/hotList")).data;return a.code===0?a:{code:-1,data:[]}}catch(r){return console.error("获取热门列表失败:",r),{code:-1,data:[]}}},O=async r=>{try{const i=(await d.get("/suggest",{params:{keyword:r},timeout:3e3})).data;return i.code===0?i:{code:-1,data:[]}}catch(a){return console.error("获取搜索建议失败:",a),{code:-1,data:[]}}},Q=x((r,a)=>{const i=JSON.parse(localStorage.getItem("searchHistory")||"[]");return{hotList:[],suggestList:[],searchHistory:i,enterLoading:!1,setHotList:async()=>{const c=await J();r({hotList:c.data})},setSuggestList:async c=>{const o=await O(c);r({suggestList:o.data})},addHistory:c=>{if(!c)return;const{searchHistory:o}=a(),l=[c,...o.filter(n=>n!==c)].slice(0,10);r({searchHistory:l}),localStorage.setItem("searchHistory",JSON.stringify(l))},clearHistory:()=>{r({searchHistory:[]}),localStorage.removeItem("searchHistory")}}}),z=()=>{j("搜索");const[r,a]=h.useState(""),{suggestList:i,setSuggestList:c,hotList:o,setHotList:l,searchHistory:n,addHistory:g,clearHistory:m}=Q();h.useEffect(()=>{l()},[]);const _=e=>{a(e),e&&(g(e),c(e))},u={display:r===""?"none":"block"};return t.jsx("div",{className:s.container,children:t.jsxs("div",{className:s.wrapper,children:[t.jsx(p,{handleQuery:_,isSearchPage:!0}),t.jsx("div",{className:s.suggestContainer,children:t.jsx("div",{className:s.list,style:u,children:i.map((e,y)=>t.jsx("div",{className:s.item,children:e},e))})}),t.jsxs("div",{className:s.suggestWrapper,children:[t.jsx("h1",{className:s.title,children:"热门推荐"}),t.jsx("div",{className:s.hot,children:o&&o.map((e,y)=>t.jsx("div",{className:s.item,children:e.keyword},e.id))}),t.jsxs("div",{className:s.history,children:[t.jsx("h2",{children:"搜索历史"}),n.length>0?t.jsxs(t.Fragment,{children:[t.jsx("ul",{className:s.historyList,children:n&&n.map((e,y)=>t.jsx("li",{className:s.historyItem,children:e},y))}),t.jsx("button",{className:s.clearBtn,onClick:m,children:"清空历史"})]}):t.jsx("p",{className:s.empty,children:"暂无搜索历史"})]})]})]})})};export{z as default};
