import{i as ge,r as l,a as ce,R as S,_ as X,c as d,S as ie,b as I,B as ve,W as he,j as s,L as ee,I as te,m as $,d as G,e as je,f as P,g as be,C as xe,p as pe}from"./index-xVZtqsxv.js";import{u as ye}from"./useTitle-BozIGF1y.js";import{g as Q,p as Ce,S as _e,P as Ne,s as Se,u as we,T as W,a as Oe}from"./useUserStore-CJR3_1bI.js";import"./middleware-D5fLyQHP.js";import"./react-BY3S3x3e.js";function Re(){return ge?/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase()):!1}function Te(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}function Ee(e){ke(window,e)}function ke(e,n){"scrollTop"in e?e.scrollTop=n:e.scrollTo(e.scrollX,n)}const Ie=Re();function ue(){Ie&&Ee(Te())}function ne(e,n,t){const r=e.indexOf(n);return r===-1?e:n==="-"&&r!==0?e.slice(0,r):e.slice(0,r+1)+e.slice(r).replace(t,"")}function Le(e,n=!0,t=!0){n?e=ne(e,".",/\./g):e=e.split(".")[0],t?e=ne(e,"-",/-/g):e=e.replace(/-/,"");const r=n?/[^-0-9.]/g:/[^-0-9]/g;return e.replace(r,"")}function ze(e){const[n,t]=l.useState(e),r=l.useRef(n),h=l.useCallback(a=>{t(f=>r.current=ce(a)?a(f):a)},[n]);return[n,h,r]}const Pe=()=>{const e=l.useRef(!1);return l.useEffect(()=>(e.current=!1,()=>{e.current=!0}),[]),e},Fe=(e={})=>{const n=Pe(),[t,r,h]=ze(e),a=l.useCallback(f=>{n.current||r(m=>Object.assign(Object.assign({},m),ce(f)?f(m):f))},[]);return[t,a,h]};function Ae(e){const n=l.useRef(e);return n.current=e,n}const Me=e=>{const n=Ae(e);l.useEffect(()=>()=>{n.current()},[])};function se(e,n){if(e===n)return!0;for(let t=0;t<e.length;t++)if(!Object.is(e[t],n[t]))return!1;return!0}const $e=e=>(t,r,h)=>{const a=l.useRef(!1),f=l.useRef([]),m=l.useRef([]),u=l.useRef();e(()=>{var g;const x=(Array.isArray(h)?h:[h]).map(j=>Q(j));if(!a.current){a.current=!0,f.current=x,m.current=r,u.current=t();return}(x.length!==f.current.length||!se(x,f.current)||!se(r,m.current))&&((g=u.current)===null||g===void 0||g.call(u),f.current=x,m.current=r,u.current=t())}),Me(()=>{var g;(g=u.current)===null||g===void 0||g.call(u),a.current=!1})},Be=$e(l.useEffect);function Ve(e,n){const[t,r]=l.useState(),[h,a]=l.useState();return Be(()=>{const f=Q(e);if(!f)return;const m=new IntersectionObserver(u=>{for(const g of u)a(g.intersectionRatio),r(g.isIntersecting)},Object.assign(Object.assign({},n),{root:Q(n==null?void 0:n.root)}));return m.observe(f),()=>{m.disconnect()}},[],e),[t,h]}const He=()=>{const[,e]=l.useState({});return l.useCallback(()=>e({}),[])};function We(e){const n=l.useRef(e);n.current=l.useMemo(()=>e,[e]);const t=l.useRef();return t.current||(t.current=function(...r){return n.current.apply(this,r)}),t.current}function de(e){const{value:n,defaultValue:t,onChange:r}=e,h=He(),a=l.useRef(n!==void 0?n:t);n!==void 0&&(a.current=n);const f=We((m,u)=>{const g=typeof m=="function"?m(a.current):m;!u&&g===a.current||(a.current=g,h(),r==null||r(g))});return[a.current,f]}const fe=S.createContext({}),[U]=I("button"),Ue=e=>{const{color:n,loading:t,className:r,hairline:h,loadingText:a,round:f,square:m,plain:u,block:g,loadingType:w,nativeType:x,iconPosition:j}=e,O=X(e,["color","loading","className","hairline","loadingText","round","square","plain","block","loadingType","nativeType","iconPosition"]),{parent:o}=l.useContext(fe),R=S.useMemo(()=>e.size||(o==null?void 0:o.size)||"normal",[o==null?void 0:o.size,e.size]),_=S.useMemo(()=>e.type||(o==null?void 0:o.type)||"default",[o==null?void 0:o.type,e.type]),b=S.useMemo(()=>u??(o==null?void 0:o.plain),[o==null?void 0:o.plain,u]),p=S.useMemo(()=>g??(o==null?void 0:o.block),[o==null?void 0:o.block,g]),T=S.useMemo(()=>j||(o==null?void 0:o.iconPosition)||"left",[o==null?void 0:o.iconPosition,j]),N=S.useMemo(()=>{var v;return(v=e.disabled)!==null&&v!==void 0?v:o==null?void 0:o.disabled},[o==null?void 0:o.disabled,e.disabled]),L=S.useMemo(()=>x||(o==null?void 0:o.nativeType)||"button",[o==null?void 0:o.nativeType,x]),F=S.useMemo(()=>e.tag||(o==null?void 0:o.tag)||"button",[o==null?void 0:o.tag,e.tag]),B=d(r,U([_,R,{plain:b,loading:t,disabled:N,hairline:h,block:p,round:f,square:m}]),{[ve]:h},e.shadow&&`${ie}--${+e.shadow}`),k=Object.assign({},e.style);n&&(k.color=b?n:he,b||(k.background=n),n.indexOf("gradient")!==-1?k.border=0:k.borderColor=n);const V=v=>{!t&&!N&&e.onClick&&e.onClick(v)},H=()=>{if(t){const{loadingSize:v="20px"}=e;return s.jsx(ee,{className:d(U("loading")),size:v,type:w,color:_==="default"?void 0:""})}return null},C=()=>e.loading?H():e.icon?S.cloneElement(e.icon,{className:d(U("icon"))}):null,c=()=>{let v;return t?v=a:v=e.children||e.text,v?s.jsx("span",Object.assign({className:d(U("text"))},{children:v}),"text"):null},i=()=>s.jsxs("div",Object.assign({className:d(U("content"))},{children:[T==="left"&&C(),c(),T==="right"&&C()]}));return s.jsx(F,Object.assign({},O,{disabled:N,className:B,style:k,type:L,onClick:V},{children:i()}))},[Ke]=I("button-group"),De=e=>{var{className:n,style:t,children:r,onClick:h}=e,a=X(e,["className","style","children","onClick"]);const f=m=>{a.disabled||h==null||h(m)};return s.jsx("div",Object.assign({onClick:f,style:t,className:d(n,Ke([a.type,{round:a.round,plain:a.plain,disabled:a.disabled}]),a.shadow&&`${ie}--${+a.shadow}`)},{children:s.jsx(fe.Provider,Object.assign({value:{parent:a}},{children:r}))}))},q=Object.assign(Ue,{Group:De}),Ye=e=>l.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},e),l.createElement("path",{d:"M500 55.556c245.46 0 444.444 198.984 444.444 444.444S745.46 944.444 500 944.444 55.556 745.46 55.556 500 254.54 55.556 500 55.556zm176.441 267.887c-10.848-10.848-28.436-10.848-39.284 0L499.665 460.936 362.172 323.443c-10.848-10.848-28.436-10.848-39.284 0-10.848 10.848-10.848 28.436 0 39.284L460.38 500.22 322.888 637.713c-10.848 10.848-10.848 28.436 0 39.284 10.848 10.848 28.436 10.848 39.284 0l137.493-137.493 137.492 137.493c10.848 10.848 28.436 10.848 39.284 0 10.848-10.848 10.848-28.436 0-39.284L538.948 500.22l137.493-137.493c10.848-10.848 10.848-28.436 0-39.284z",fillRule:"evenodd"})),Z=l.forwardRef((e,n)=>l.createElement(te,Object.assign({name:"SvgClear"},e,{ref:n}),l.createElement(Ye,null))),Ge=e=>l.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},e),l.createElement("path",{d:"M389.334 167l-18.5 55.556H111.556v388.889l71.833-71.833c20.051-20.052 51.558-21.594 73.372-4.628l5.24 4.628 71.777 71.833 102.89-123.5L556 667l-55.556 166.667h-388.89c-28.476 0-51.97-21.46-55.181-49.08L56 778.112V222.556c0-28.528 21.46-51.978 49.08-55.183l6.476-.373h277.778zm500 0c28.528 0 51.978 21.412 55.183 49.07l.373 6.486v555.556c0 28.476-21.412 51.97-49.07 55.182l-6.486.374H611.556L667.112 667 498.389 413.889l71.112-85.278c20.533-24.681 57.182-26.569 80.135-5.481l4.698 4.87 235 274.167V222.556H481.945l18.5-55.556h388.89zM306.028 278.089c15.508 0 30.03 4.243 42.47 11.63l-14.72 43.948 45.282 67.904c-14.188 25.737-41.585 43.185-73.032 43.185-46 0-83.333-37.333-83.333-83.334 0-46 37.333-83.333 83.333-83.333z",fillRule:"evenodd"})),qe=l.forwardRef((e,n)=>l.createElement(te,Object.assign({name:"SvgPhotoFail"},e,{ref:n}),l.createElement(Ge,null))),Xe=e=>l.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor"},e),l.createElement("path",{d:"M305.583 277.756c-46 0-83.333 37.333-83.333 83.333s37.333 83.333 83.333 83.333 83.334-37.333 83.334-83.333-37.334-83.333-83.334-83.333m348.306 49.91c-22.333-26.11-62.833-25.833-84.833.612L333.333 611.11l-71.777-71.833c-21.723-21.722-56.89-21.722-78.612 0l-71.833 71.833V222.222H888.89v379.611l-235-274.166zm235-161H111.11c-30.667 0-55.555 24.834-55.555 55.556v555.555c0 30.667 24.888 55.556 55.555 55.556H888.89c30.722 0 55.555-24.889 55.555-55.555V222.222c0-30.722-24.833-55.555-55.555-55.555z",fillRule:"evenodd"})),me=l.forwardRef((e,n)=>l.createElement(te,Object.assign({name:"SvgPhoto"},e,{ref:n}),l.createElement(Xe,null))),[K]=I("input"),Je=l.forwardRef((e,n)=>{const t=$(e,{clearIcon:s.jsx(Z,{}),clearTrigger:"focus",defaultValue:""}),r=l.useRef(),[h,a]=l.useState(!1),f=l.useRef(!1),[m,u]=de(t),{className:g,style:w,align:x,type:j,name:O,placeholder:o,disabled:R,readOnly:_,maxLength:b,autoFocus:p}=t,T=()=>{r!=null&&r.current&&r.current.focus()},N=()=>{r!=null&&r.current&&r.current.blur()};l.useImperativeHandle(n,()=>({clear:()=>{u("")},focus:T,blur:N,get nativeElement(){return r.current}}));const L=l.useMemo(()=>{if(t.clearable&&!_){const C=m!=="",c=t.clearTrigger==="always"||t.clearTrigger==="focus"&&h;return C&&c}return!1},[m,t.clearTrigger,h]),z=C=>{var c;let i=C;if(!f.current&&(G(b)&&i.length>+b&&(i=i.slice(0,b),(c=t.onOverlimit)===null||c===void 0||c.call(t)),j==="number"||j==="digit")){const v=j==="number";i=Le(i,v,v)}u(i)},F=C=>{var c;a(!0),(c=t.onFocus)===null||c===void 0||c.call(t,C),_&&N()},B=C=>{var c;a(!1),(c=t.onBlur)===null||c===void 0||c.call(t,C),ue()},k=C=>{var c;(C.key==="Enter"||+C.charCode==13)&&(Ce(C),t.type==="search"&&N()),(c=t.onKeyPress)===null||c===void 0||c.call(t,C)},V=()=>{let C=j,c;return j==="number"&&(C="text",c="decimal"),j==="digit"&&(C="tel",c="numeric"),s.jsx("input",{value:m,type:C,inputMode:c,ref:r,name:O,className:d(K("control")),disabled:R,autoFocus:p,readOnly:_,placeholder:o||"",onBlur:B,onFocus:F,onChange:i=>{var v;return z((v=i==null?void 0:i.currentTarget)===null||v===void 0?void 0:v.value)},onKeyPress:k,autoCapitalize:t.autoCapitalize,autoCorrect:t.autoCorrect,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,onCompositionStart:i=>{var v;f.current=!0,(v=t.onCompositionStart)===null||v===void 0||v.call(t,i)},onCompositionEnd:i=>{var v,A;f.current=!1,(v=t.onCompositionEnd)===null||v===void 0||v.call(t,i),z((A=i==null?void 0:i.currentTarget)===null||A===void 0?void 0:A.value)},onClick:t.onClick})},H=C=>{var c;u(""),(c=t.onClear)===null||c===void 0||c.call(t,C)};return s.jsxs("div",Object.assign({className:d(K([x]),g),style:w},{children:[t.prefix&&s.jsx("div",Object.assign({className:d(K("prefix"))},{children:t.prefix})),V(),L&&S.cloneElement(t.clearIcon||s.jsx(Z,{}),{className:d(K("clear")),onTouchStart:H}),t.suffix&&s.jsx("div",Object.assign({className:d(K("suffix"))},{children:t.suffix}))]}))}),[D]=I("textarea"),Qe=l.forwardRef((e,n)=>{const t=$(e,{rows:2,clearIcon:s.jsx(Z,{}),clearTrigger:"focus",defaultValue:""}),[r,h]=l.useState(!1),a=l.useRef(),f=l.useRef(!1),[m,u]=de(t),{className:g,style:w,name:x,rows:j,placeholder:O,disabled:o,readOnly:R,maxLength:_,showWordLimit:b,autoFocus:p}=t,T=()=>{a!=null&&a.current&&a.current.focus()},N=()=>{a!=null&&a.current&&a.current.blur()};l.useImperativeHandle(n,()=>({clear:()=>{u("")},focus:T,blur:N,get nativeElement(){return a.current}}));const L=()=>{const c=a.current;if(!c)return;c.style.height="auto";let i=c.scrollHeight;if(je(t.autoSize)){const{maxHeight:v,minHeight:A}=t.autoSize;v&&(i=Math.min(i,v)),A&&(i=Math.max(i,A))}i&&(c.style.height=`${i}px`)};l.useEffect(()=>{L()},[m]);const z=S.useMemo(()=>D("control",[{"min-height":!t.autoSize,clear:t.clearable}]),[t.autoSize]),F=c=>{var i;let v=c;f.current||G(_)&&v.length>+_&&(v=v.slice(0,_),(i=t.onOverlimit)===null||i===void 0||i.call(t)),u(v)},B=c=>{var i;h(!0),(i=t.onFocus)===null||i===void 0||i.call(t,c),R&&N()},k=c=>{var i;h(!1),(i=t.onBlur)===null||i===void 0||i.call(t,c),ue()},V=()=>{if(b){const c=(m?`${m}`:"").length;return s.jsx("div",Object.assign({className:d(D("word-limit"))},{children:typeof b=="function"?b({currentCount:c,maxLength:_}):s.jsxs(s.Fragment,{children:[s.jsx("span",Object.assign({className:d(D("word-num"))},{children:c})),_?`/${_}`:!1]})}))}return null},H=c=>{var i;u(""),(i=t.onClear)===null||i===void 0||i.call(t,c)},C=l.useMemo(()=>{if(t.clearable&&!R){const c=m!=="",i=t.clearTrigger==="always"||t.clearTrigger==="focus"&&r;return c&&i}return!1},[m,t.clearTrigger,r]);return s.jsxs("div",Object.assign({className:d(D(),g),style:w},{children:[s.jsx("textarea",{ref:a,name:x,rows:j,className:d(z),value:m,disabled:o,autoFocus:p,readOnly:R,placeholder:O||"",onBlur:k,onFocus:B,onChange:c=>{var i;return F((i=c==null?void 0:c.currentTarget)===null||i===void 0?void 0:i.value)},onKeyPress:t.onKeyPress,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,autoComplete:t.autoComplete,onCompositionStart:c=>{var i;f.current=!0,(i=t.onCompositionStart)===null||i===void 0||i.call(t,c)},onCompositionEnd:c=>{var i,v;f.current=!1,(i=t.onCompositionEnd)===null||i===void 0||i.call(t,c),F((v=c==null?void 0:c.currentTarget)===null||v===void 0?void 0:v.value)},onClick:t.onClick}),C&&S.cloneElement(t.clearIcon,{className:d(D("clear")),onTouchStart:H}),V()]}))}),ae=Object.assign(Je,{TextArea:Qe}),[M]=I("image"),oe=e=>{const[n,t]=Fe({loading:!0,error:!1}),r=l.useRef(null),{fit:h,errorIcon:a,loadingIcon:f,showError:m,showLoading:u,block:g}=e,w=l.useMemo(()=>{const b=Object.assign({},e.style);return G(e.width)&&(b.width=P(e.width)),G(e.height)&&(b.height=P(e.height)),G(e.radius)&&(b.overflow="hidden",b.borderRadius=P(e.radius)),b},[e.style,e.width,e.height,e.radius]);l.useEffect(()=>{const b={error:!1,loading:!0};r.current&&(r.current.complete?b.loading=!1:b.loading=!0),t(b)},[e.src]);const x=b=>{var p;t({loading:!1}),(p=e.onLoad)===null||p===void 0||p.call(e,b)},j=b=>{var p;t({error:!0,loading:!1}),(p=e.onLoad)===null||p===void 0||p.call(e,b)},O=()=>f?S.cloneElement(f,{className:d(M("loading-icon")),fontSize:e.iconSize}):null,o=()=>a?S.cloneElement(a,{className:d(M("error-icon")),fontSize:e.iconSize}):null,R=()=>n.loading&&u?s.jsx("div",Object.assign({className:d(M("loading")),onClick:e.onClick},{children:O()})):n.error&&m?s.jsx("div",Object.assign({className:d(M("error")),onClick:e.onClick},{children:o()})):null,_=()=>{if(n.error||!e.src)return null;const b={className:d(M("img")),style:{objectFit:h}};return s.jsx("img",Object.assign({ref:r,alt:e.alt||"img",src:e.src,onLoad:x,onError:j},b))};return s.jsxs("div",Object.assign({className:d(e.className,M({block:g,round:e.round})),style:w,onClick:e.onClick},{children:[_(),R(),e.children]}))},re="100%",Ze="60%",[Y]=I("skeleton"),et=e=>{var{children:n,className:t,style:r}=e,h=X(e,["children","className","style"]);const a=$(h,{loading:!0,animate:!0,round:!0,row:3,avatarShape:"round",rowWidth:re}),f=x=>{const{rowWidth:j}=a;return j===re&&x===+a.row-1&&x!==0?Ze:Array.isArray(j)?j[x]:j},m=x=>{const{rowHeight:j}=a;return Array.isArray(j)?j[x]:j},u=()=>a.avatar?s.jsx("div",{className:d(Y("avatar",a.avatarShape)),style:be(a.avatarSize)}):null,g=()=>{if(a.title){const x=P(a.titleWidth),j=P(m(0));return s.jsx("div",{className:d(Y("title")),style:{width:x,height:j}})}return null},w=()=>Array(a.row).fill("").map((x,j)=>{const O=P(f(j)),o=P(m(j));return s.jsx("div",{className:d(Y("row")),style:{width:O,height:o}},j)});return a.loading?s.jsxs("div",Object.assign({className:d(t,Y({animate:a.animate,round:a.round})),style:r},{children:[u(),s.jsxs("div",Object.assign({className:d(Y("content"))},{children:[g(),w()]}))]})):s.jsx(s.Fragment,{children:n})},[tt]=I("lazyload"),nt=e=>{const n=$(e,{placeholder:s.jsx(et,{title:!0})}),t=l.useRef(),[r]=Ve(t),{height:h,placeholder:a,children:f,className:m,style:u}=n;return r?s.jsx(s.Fragment,{children:f}):s.jsx("div",Object.assign({ref:t,className:d(tt(),m),style:Object.assign({height:h},u)},{children:a}))},le=e=>s.jsx("div",Object.assign({className:d(e("loading"))},{children:s.jsx(me,{className:d(e("loading-icon"))})})),[J]=I("image"),st=e=>{const n=$(e,{fit:"fill",errorIcon:s.jsx(qe,{}),loadingIcon:s.jsx(me,{}),showError:!0,showLoading:!0,block:!0}),{lazyload:t}=n,r=X(n,["lazyload"]),h=()=>typeof t=="boolean"?le(J):t.placeholder||le(J);if(t){const{className:a,style:f,height:m,width:u}=r,g={className:d(a,J({block:r.block})),style:Object.assign(Object.assign({},f),{height:m,width:u})};return s.jsx(nt,Object.assign({},g,{placeholder:h()},{children:s.jsx(oe,Object.assign({},r))}))}return s.jsx(oe,Object.assign({},r))},at=Symbol("image"),ot=Object.assign(st,{[xe]:at}),[E]=I("action-sheet"),rt=e=>{const n=$(e,{closeable:!0,safeAreaInsetBottom:!0,round:!0,lockScroll:!0,overlay:!0,closeOnClickOverlay:!0,closeIcon:s.jsx(_e,{})}),t=()=>{var u,g;(u=n.onClose)===null||u===void 0||u.call(n),(g=n.onCancel)===null||g===void 0||g.call(n)},r=()=>n.title?s.jsxs("div",Object.assign({className:d(E("header"))},{children:[n.title,n.closeable&&S.cloneElement(n.closeIcon,{className:d(E("clear")),onClick:t})]})):null,h=()=>n.cancelText?[s.jsx("div",{className:d(E("gap"))},"cancel-gap"),s.jsx("button",Object.assign({type:"button",className:d(E("cancel")),onClick:t},{children:n.cancelText}),"cancel-btn")]:null,a=(u,g)=>{const{name:w,color:x,subname:j,loading:O,callback:o,disabled:R,className:_,style:b}=u,p=O?s.jsx(ee,{className:d(E("loading-icon"))}):[s.jsx("span",Object.assign({className:d(E("name"))},{children:w}),`${g}-1`),j&&s.jsx("div",Object.assign({className:d(E("subname"))},{children:j}),`${g}-2`)],T=()=>{R||O||(o&&o(u),n.closeOnClickAction&&t(),setTimeout(()=>{var N;(N=n.onSelect)===null||N===void 0||N.call(n,u,g)},0))};return s.jsx("button",Object.assign({type:"button",style:Object.assign({color:x},b),className:d(E("item",{loading:O,disabled:R}),_),onClick:T},{children:p}),g)},f=()=>n.description?s.jsx("div",Object.assign({className:d(E("description"))},{children:n.description})):null,m=()=>n.actions?n.actions.map(a):null;return s.jsx(Ne,Object.assign({visible:n.visible,className:d(E("wrapper")),position:"bottom"},pe(n,Se),{onClose:t,closeable:!1},{children:s.jsxs("div",Object.assign({className:d(E(),n.className),style:n.style},{children:[r(),f(),s.jsxs("div",Object.assign({className:d(E("content"))},{children:[m(),n.children]})),h()]}))}))},lt="_container_1c1jp_45",ct="_userInfo_1c1jp_73",it="_avatarContainer_1c1jp_91",ut="_avatar_1c1jp_91",dt="_avatarLoading_1c1jp_133",ft="_userText_1c1jp_149",mt="_nickname_1c1jp_161",gt="_status_1c1jp_197",vt="_editContainer_1c1jp_231",ht="_editInput_1c1jp_245",jt="_editButtons_1c1jp_263",bt="_tips_1c1jp_305",xt="_badges_1c1jp_307",pt="_settings_1c1jp_309",yt="_tipCard_1c1jp_325",Ct="_badgeList_1c1jp_341",_t="_badge_1c1jp_307",Nt="_settingsList_1c1jp_373",St="_settingItem_1c1jp_385",y={container:lt,userInfo:ct,avatarContainer:it,avatar:ut,avatarLoading:dt,userText:ft,nickname:mt,status:gt,editContainer:vt,editInput:ht,editButtons:jt,tips:bt,badges:xt,settings:pt,tipCard:yt,badgeList:Ct,badge:_t,settingsList:Nt,settingItem:St},kt=()=>{ye("我的小天地");const e=we(),{userInfo:n,setUserInfo:t}=e;console.log("当前头像地址:",n==null?void 0:n.avatar);const[r,h]=l.useState(null),[a,f]=l.useState(""),[m,u]=l.useState(!1),[g,w]=l.useState(!1);l.useRef(0);const x=l.useRef(null),j=[{name:"AI生成头像",color:"#ee0a24",type:1},{name:"上传头像",color:"#123123",type:2}],O=async b=>{if(u(!1),b.type===1)try{w(!0);const p=`昵称: ${n.nickname}
个性签名: ${n.status}`,T=await Oe(p);T&&(T.startsWith("http")||T.startsWith("data:"))?(e.setUserInfo({avatar:T}),W.success("头像生成成功！")):W.fail("头像生成失败，请重试")}catch(p){console.error("生成头像失败:",p),W.fail("头像生成失败，请稍后再试")}finally{w(!1)}else if(b.type===2){const p=document.createElement("input");p.type="file",p.accept="image/*",p.onchange=T=>{const N=T.target.files[0];if(N){const L=new FileReader;L.onload=z=>{e.setUserInfo({avatar:z.target.result}),W.success("头像上传成功！")},L.readAsDataURL(N)}},p.click()}},o=b=>{h(b),f(n[b]),setTimeout(()=>{var p;return(p=x.current)==null?void 0:p.focus()},100)},R=()=>{a.trim()&&(e.setUserInfo({[r]:a}),W.success("修改成功！")),h(null)},_=()=>{h(null)};return s.jsxs("div",{className:y.container,children:[s.jsxs("section",{className:y.userInfo,children:[s.jsxs("div",{className:y.avatarContainer,children:[s.jsx(ot,{round:!0,src:n.avatar,alt:"头像",className:y.avatar,onClick:()=>u(!0)}),g&&s.jsx(ee,{className:y.avatarLoading})]}),s.jsxs("div",{className:y.userText,children:[r==="nickname"?s.jsxs("div",{className:y.editContainer,children:[s.jsx(ae,{ref:x,value:a,onChange:f,className:y.editInput}),s.jsxs("div",{className:y.editButtons,children:[s.jsx(q,{size:"small",onClick:R,children:"保存"}),s.jsx(q,{size:"small",plain:!0,onClick:_,children:"取消"})]})]}):s.jsx("h2",{className:y.nickname,onClick:()=>o("nickname"),children:n.nickname}),r==="status"?s.jsxs("div",{className:y.editContainer,children:[s.jsx(ae,{ref:x,value:a,onChange:f,className:y.editInput}),s.jsxs("div",{className:y.editButtons,children:[s.jsx(q,{size:"small",onClick:R,children:"保存"}),s.jsx(q,{size:"small",plain:!0,onClick:_,children:"取消"})]})]}):s.jsx("p",{className:y.status,onClick:()=>o("status"),children:n.status})]})]}),s.jsxs("section",{className:y.tips,children:[s.jsx("h3",{children:"🐾 Kitty 小贴士"}),s.jsx("div",{className:y.tipCard,children:"多喝热水，保持好心情"})]}),s.jsxs("section",{className:y.badges,children:[s.jsx("h3",{children:"🏅 我的勋章"}),s.jsxs("div",{className:y.badgeList,children:[s.jsx("div",{className:y.badge,children:"📅 连续打卡 7 天"}),s.jsx("div",{className:y.badge,children:"💬 聊天 100 次"})]})]}),s.jsxs("section",{className:y.settings,children:[s.jsx("h3",{children:"⚙️ 应用设置"}),s.jsxs("ul",{className:y.settingsList,children:[s.jsx("li",{className:y.settingItem,children:"账号设置"}),s.jsx("li",{className:y.settingItem,children:"安全与隐私"}),s.jsx("li",{className:y.settingItem,children:"通知与提醒"})]})]}),s.jsx(rt,{visible:m,actions:j,cancelText:"取消",onCancel:()=>u(!1),onSelect:O,timeout:300})]})};export{kt as default};
