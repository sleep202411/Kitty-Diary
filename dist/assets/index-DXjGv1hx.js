import{r as n,j as e}from"./index-xVZtqsxv.js";import{u as I}from"./useTitle-BozIGF1y.js";const H="_storyContainer_1jsv7_31",P="_inputPanel_1jsv7_69",T="_textInput_1jsv7_117",E="_styleSelector_1jsv7_181",O="_styleSelect_1jsv7_181",z="_generateButton_1jsv7_279",D="_storyCard_1jsv7_345",R="_cardHeader_1jsv7_413",$="_styleBadge_1jsv7_449",q="_storyContent_1jsv7_475",A="_regenerateButton_1jsv7_515",s={storyContainer:H,inputPanel:P,textInput:T,styleSelector:E,styleSelect:O,generateButton:z,storyCard:D,cardHeader:R,styleBadge:$,storyContent:q,regenerateButton:A},U=()=>{var v,h;I("故事宝箱");const S="cztei_qH6KwCs1pqHnDQipPl0qeV0amcX12VUAj02sGXGfCMisSw8VpkiNjsA9Tas4Estzp",f="https://api.coze.cn/v1/workflow/run",x="7537625801082077234",[i,w]=n.useState(""),[o,C]=n.useState("random"),[a,b]=n.useState(null),[m,l]=n.useState(""),[_,u]=n.useState(!1),d=[{value:"random",label:"任意风格",emoji:"🎲"},{value:"fantasy",label:"奇幻冒险",emoji:"🧙‍♂️"},{value:"sci-fi",label:"科幻未来",emoji:"🚀"},{value:"fairy-tale",label:"经典童话",emoji:"🏰"},{value:"mystery",label:"悬疑推理",emoji:"🔍"},{value:"animal",label:"动物世界",emoji:"🐾"},{value:"historical",label:"历史传奇",emoji:"⏳"}],p=async(t=!1)=>{try{if(!i.trim()){l("请输入关键词");return}t?u(!0):l("生成中...");const r={user_input:i};o!=="random"&&(r.story_style=o);const c=await fetch(f,{method:"POST",headers:{Authorization:`Bearer ${S.trim()}`,"Content-Type":"application/json"},body:JSON.stringify({workflow_id:x,parameters:r})});if(!c.ok){const j=await c.json();throw new Error(j.msg||`HTTP错误: ${c.status}`)}const B=await c.text();let y;try{y=JSON.parse(B)}catch(j){throw new Error(`响应解析失败: ${j.message}`)}if(!y.data)throw new Error("无效的响应格式");const g=JSON.parse(y.data),k={title:g.story_title||"未命名故事",content:g.story_content||"未能生成内容",style:o};b(k),l("生成成功！"),u(!1)}catch(r){console.error("生成失败:",r),l(`错误: ${r.message}`),u(!1)}},N=()=>{p(!0)};return e.jsxs("div",{className:s.storyContainer,children:[e.jsxs("div",{className:s.inputPanel,children:[e.jsx("h2",{children:"✨ 故事宝箱 ✨"}),e.jsx("textarea",{value:i,onChange:t=>w(t.target.value),placeholder:"输入关键词或灵感 (例如：太空猫、魔法钥匙、会跳舞的星星...)",className:s.textInput,rows:5}),e.jsxs("div",{className:s.styleSelector,children:[e.jsx("label",{children:"故事风格："}),e.jsx("select",{value:o,onChange:t=>C(t.target.value),className:s.styleSelect,children:d.map(t=>e.jsxs("option",{value:t.value,children:[t.emoji," ",t.label]},t.value))})]}),e.jsx("button",{onClick:()=>p(!1),disabled:m.includes("生成"),className:s.generateButton,children:m||"生成故事"})]}),a&&e.jsxs("div",{className:s.storyCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:String(a.title)}),e.jsxs("span",{className:s.styleBadge,children:[((v=d.find(t=>t.value===a.style))==null?void 0:v.emoji)||"📖",((h=d.find(t=>t.value===a.style))==null?void 0:h.label)||"故事"]})]}),e.jsx("div",{className:s.storyContent,children:a.content}),e.jsx("button",{onClick:N,disabled:_,className:s.regenerateButton,children:_?"正在生成...":"再次生成"})]})]})};export{U as default};
