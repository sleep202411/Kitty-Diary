import{r as n,j as e}from"./index-7FYdZ7LW.js";import{u as I}from"./useTitle-I86CEnKF.js";const P="_storyContainer_1jsv7_31",T="_inputPanel_1jsv7_69",H="_textInput_1jsv7_117",O="_styleSelector_1jsv7_181",E="_styleSelect_1jsv7_181",J="_generateButton_1jsv7_279",D="_storyCard_1jsv7_345",R="_cardHeader_1jsv7_413",$="_styleBadge_1jsv7_449",U="_storyContent_1jsv7_475",q="_regenerateButton_1jsv7_515",s={storyContainer:P,inputPanel:T,textInput:H,styleSelector:O,styleSelect:E,generateButton:J,storyCard:D,cardHeader:R,styleBadge:$,storyContent:U,regenerateButton:q},G=()=>{var h,p;I("故事宝箱");const S="pat_BW3DvOatetgn6JG5hU112l6oCKxhpp52vACcPBJSyhkenqdfk9Bqp95nH6TrWLrw",x="https://api.coze.cn/v1/workflow/run",f="7537625801082077234",[i,w]=n.useState(""),[o,C]=n.useState("random"),[a,B]=n.useState(null),[m,l]=n.useState(""),[_,d]=n.useState(!1),u=[{value:"random",label:"任意风格",emoji:"🎲"},{value:"fantasy",label:"奇幻冒险",emoji:"🧙‍♂️"},{value:"sci-fi",label:"科幻未来",emoji:"🚀"},{value:"fairy-tale",label:"经典童话",emoji:"🏰"},{value:"mystery",label:"悬疑推理",emoji:"🔍"},{value:"animal",label:"动物世界",emoji:"🐾"},{value:"historical",label:"历史传奇",emoji:"⏳"}],v=async(t=!1)=>{try{if(!i.trim()){l("请输入关键词");return}t?d(!0):l("生成中...");const r={user_input:i};o!=="random"&&(r.story_style=o);const c=await fetch(x,{method:"POST",headers:{Authorization:`Bearer ${S.trim()}`,"Content-Type":"application/json"},body:JSON.stringify({workflow_id:f,parameters:r})});if(!c.ok){const j=await c.json();throw new Error(j.msg||`HTTP错误: ${c.status}`)}const N=await c.text();let y;try{y=JSON.parse(N)}catch(j){throw new Error(`响应解析失败: ${j.message}`)}if(!y.data)throw new Error("无效的响应格式");const g=JSON.parse(y.data),k={title:g.story_title||"未命名故事",content:g.story_content||"未能生成内容",style:o};B(k),l("生成成功！"),d(!1)}catch(r){console.error("生成失败:",r),l(`错误: ${r.message}`),d(!1)}},b=()=>{v(!0)};return e.jsxs("div",{className:s.storyContainer,children:[e.jsxs("div",{className:s.inputPanel,children:[e.jsx("h2",{children:"✨ 故事宝箱 ✨"}),e.jsx("textarea",{value:i,onChange:t=>w(t.target.value),placeholder:"输入关键词或灵感 (例如：太空猫、魔法钥匙、会跳舞的星星...)",className:s.textInput,rows:5}),e.jsxs("div",{className:s.styleSelector,children:[e.jsx("label",{children:"故事风格："}),e.jsx("select",{value:o,onChange:t=>C(t.target.value),className:s.styleSelect,children:u.map(t=>e.jsxs("option",{value:t.value,children:[t.emoji," ",t.label]},t.value))})]}),e.jsx("button",{onClick:()=>v(!1),disabled:m.includes("生成"),className:s.generateButton,children:m||"生成故事"})]}),a&&e.jsxs("div",{className:s.storyCard,children:[e.jsxs("div",{className:s.cardHeader,children:[e.jsx("h3",{children:String(a.title)}),e.jsxs("span",{className:s.styleBadge,children:[((h=u.find(t=>t.value===a.style))==null?void 0:h.emoji)||"📖",((p=u.find(t=>t.value===a.style))==null?void 0:p.label)||"故事"]})]}),e.jsx("div",{className:s.storyContent,children:a.content}),e.jsx("button",{onClick:b,disabled:_,className:s.regenerateButton,children:_?"正在生成...":"再次生成"})]})]})};export{G as default};
